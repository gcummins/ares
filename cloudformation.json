{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "Demo stack for ARES project",
  "Parameters" : {
    "S3Bucket" : {
      "Default" : "sai-ares-demo-static-site",
      "Description" : "Name of the bucket that holds the site",
      "Type" : "String"
    },
    "StaticSiteCodeBuildProjectName" : {
      "Default" : "sai-ares-demo-static-site-project",
      "Description" : "Name of the static site code build project",
      "Type" : "String"
    }
  },
  "Resources" : {
    "S3BucketStaticContent" : {
      "Type" : "AWS::S3::Bucket",
      "Properties" : {
        "BucketName" : {"Ref" : "S3Bucket"},
        "AccessControl" : "PublicReadWrite",
        "Tags" : [
            {
                "Key": "customer",
                "Value": "aland"
            },
            {
                "Key" : "project",
                "Value": "ares"
            }
        ],
        "WebsiteConfiguration" : {
          "IndexDocument" : {
            "Fn::Join" : [
              "/",
              [
                {
                  "Ref" : "StaticSiteCodeBuildProjectName"
                },
                "index.html"
              ]
            ]
          }
        }
      }
    },
    "CodeBuildProject" : {
      "Type" : "AWS::CodeBuild::Project",
      "Properties" : {
          "Name": {"Ref": "StaticSiteCodeBuildProjectName"},
          "Source": {
              "Type": "GITHUB",
              "Location": "https://gcummins:1ccfa9078ca7bdfc09d9ab869b160b2b1a0d5bff@github.com/gcummins/ares.git"
          },
          "Artifacts": {
              "Type": "S3",
              "Location": {"Ref" : "S3Bucket"}
          },
          "Environment": {
              "Type": "LINUX_CONTAINER",
              "Image": "aws/codebuild/ubuntu-base:14.04",
              "ComputeType": "BUILD_GENERAL1_SMALL"
          },
          "ServiceRole": "arn:aws:iam::729161019481:role/CodeBuildServiceRole"
      }
    }
  }
}
